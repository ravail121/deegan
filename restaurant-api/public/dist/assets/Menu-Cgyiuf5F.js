import{_ as D,u as B,r as g,w as j,c as r,o,a as e,f as $,t as f,F as I,g as F,h as N,d as z,v as H,i as Y,n as A,j as P,k as O,l as G,m as J,p as K,q as _,s as q,x as W}from"./main-B0o3yjtm.js";import{M as X}from"./MealNotesInput-De0w6c7Y.js";const Z={class:"card"},ee=["src","alt"],te={class:"row head"},se={class:"name"},ae={class:"price"},le={class:"desc"},ne={class:"row foot"},ie={key:0,class:"badges"},oe={class:"badge"},re={key:0,class:"overlay"},ue={class:"modal"},ce={class:"title"},de={key:0,class:"section"},ve=["value"],me={key:1,class:"section"},pe=["value"],ge={class:"section row"},he={class:"qty"},fe={key:2,class:"remove-warning"},ye={class:"section"},ke={class:"actions"},be={__name:"MenuItemCard",props:{item:{type:Object,required:!0}},setup(u){const y=u,v=B(),m=g(!1),d=g(1),k=g(null),c=g([]),b=g(""),h=g(null),C=()=>v.items.findIndex(l=>l.id===y.item.id&&k.value?.sizeID===l.variant?.sizeID);j(m,l=>{if(l)if(c.value=[],b.value="",k.value=y.item.sizes&&y.item.sizes.length>0?y.item.sizes[0]:null,h.value=C(),h.value!==-1){const s=v.items[h.value];d.value=s.qty,b.value=s.notes||"",s.addOns&&(c.value=[...s.addOns])}else d.value=1}),j(k,()=>{if(m.value)if(h.value=C(),h.value!==-1){const l=v.items[h.value];d.value=l.qty,b.value=l.notes||"",l.addOns&&(c.value=[...l.addOns])}else d.value=1,b.value="",c.value=[]});function p(){const l=c.value.reduce((i,w)=>i+Number(w.price),0),s=k.value?Number(k.value.price):y.item.price;if(d.value===0){h.value!==-1&&v.remove(h.value),m.value=!1;return}if(h.value!==-1){const i=v.items[h.value];i.qty=d.value,i.price=s+l,i.addOns=c.value,i.notes=b.value,i.presetNotes=y.item.notes||[],v.saveToStorage()}else v.add({id:y.item.id,name:y.item.name,image:y.item.image,price:s+l,variant:k.value,addOns:c.value,qty:d.value,notes:b.value,presetNotes:y.item.notes||[]});m.value=!1}return(l,s)=>(o(),r("article",Z,[e("img",{src:u.item.image,alt:u.item.name,class:"photo"},null,8,ee),e("div",te,[e("h3",se,f(u.item.name),1),e("div",ae,"$"+f(Number(u.item.price).toFixed(2)),1)]),e("p",le,f(u.item.desc),1),e("div",ne,[u.item.badge?(o(),r("div",ie,[e("span",oe,f(u.item.badge),1)])):$("",!0),e("button",{class:"add",onClick:s[0]||(s[0]=i=>m.value=!0)},"ADD")]),m.value?(o(),r("div",re,[e("div",ue,[e("h2",ce,f(u.item.name),1),u.item.sizes&&u.item.sizes.length>0?(o(),r("section",de,[s[7]||(s[7]=e("h3",null,"Choose Size",-1)),(o(!0),r(I,null,F(u.item.sizes,i=>(o(),r("label",{key:i.sizeID,class:"option"},[N(e("input",{type:"radio",name:"variant",value:i,"onUpdate:modelValue":s[1]||(s[1]=w=>k.value=w)},null,8,ve),[[H,k.value]]),z(" "+f(i.sizeName)+" ($"+f(Number(i.price).toFixed(2))+") ",1)]))),128))])):$("",!0),u.item.addons&&u.item.addons.length>0?(o(),r("section",me,[s[8]||(s[8]=e("h3",null,"Add-ons",-1)),(o(!0),r(I,null,F(u.item.addons,i=>(o(),r("label",{key:i.addonID,class:"option"},[N(e("input",{type:"checkbox",value:i,"onUpdate:modelValue":s[2]||(s[2]=w=>c.value=w)},null,8,pe),[[Y,c.value]]),z(" "+f(i.addonName)+" (+$"+f(Number(i.price).toFixed(2))+") ",1)]))),128))])):$("",!0),e("section",ge,[s[9]||(s[9]=e("h3",null,"Quantity",-1)),e("div",he,[e("button",{onClick:s[3]||(s[3]=i=>d.value>0&&d.value--)},"-"),e("span",{class:A({"qty-zero":d.value===0})},f(d.value),3),e("button",{onClick:s[4]||(s[4]=i=>d.value++)},"+")])]),d.value===0&&h.value!==-1?(o(),r("div",fe," âš ï¸ This item will be removed from your cart ")):$("",!0),e("section",ye,[P(X,{"preset-notes":u.item.notes||[],modelValue:b.value,"onUpdate:modelValue":s[5]||(s[5]=i=>b.value=i)},null,8,["preset-notes","modelValue"])]),e("div",ke,[e("button",{class:"cancel",onClick:s[6]||(s[6]=i=>m.value=!1)},"Cancel"),e("button",{class:"confirm",onClick:p},"Add to Cart")])])])):$("",!0)]))}},$e=D(be,[["__scopeId","data-v-79ef7dcf"]]),Ce={class:"sheet"},we={class:"section"},Ie={class:"section"},xe={class:"grid2"},Fe=["checked","onChange"],Se={class:"section"},_e={class:"rangebox"},Ne={class:"range-label"},Me={__name:"FilterSheet",props:{open:Boolean,categories:{type:Array,default:()=>[]},prices:{type:Array,default:()=>[]}},emits:["close","apply-filters"],setup(u,{emit:y}){const v=g(20),m=g([]),d=g(""),k=u,c=y,b=p=>{const l=m.value.indexOf(p);l>-1?m.value.splice(l,1):m.value.push(p)},h=()=>{const p={categories:m.value.map(l=>{const s=k.categories.find(i=>i.id===l);return{id:s.id,label:s.label}}),price:v.value,search:d.value.trim()};c("apply-filters",p)},C=()=>{m.value=[],v.value=20,d.value="",c("apply-filters",{categories:[],price:null,search:""})};return(p,l)=>u.open?(o(),r("div",{key:0,class:"overlay",onClick:l[2]||(l[2]=G(s=>p.$emit("close"),["self"]))},[e("div",Ce,[l[6]||(l[6]=e("h2",{class:"title"},"Filter Menu",-1)),e("section",we,[l[3]||(l[3]=e("h3",null,"Search",-1)),N(e("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=s=>d.value=s),placeholder:"Search menu items...",class:"search-input"},null,512),[[O,d.value]])]),e("section",Ie,[l[4]||(l[4]=e("h3",null,"Categories",-1)),e("div",xe,[(o(!0),r(I,null,F(u.categories,s=>(o(),r("label",{key:s.id,class:"opt"},[e("input",{type:"checkbox",checked:m.value.includes(s.id),onChange:i=>b(s.id)},null,40,Fe),e("span",null,f(s.label),1)]))),128))])]),e("section",Se,[l[5]||(l[5]=e("h3",null,"Price Range",-1)),e("div",_e,[N(e("input",{type:"range",min:"0",max:"100",step:"1","onUpdate:modelValue":l[1]||(l[1]=s=>v.value=s)},null,512),[[O,v.value]]),e("div",Ne," Selected: $0 â€“ $"+f(v.value),1)])]),e("div",{class:"actions"},[e("button",{class:"ghost",onClick:C},"RESET"),e("button",{class:"primary",onClick:h},"APPLY FILTERS")])])])):$("",!0)}},Ae=D(Me,[["__scopeId","data-v-6af1a627"]]),De={class:"wrap"},Ve={class:"topbar"},je={key:0,class:"badge"},ze={class:"cats",role:"tablist","aria-label":"Categories"},Oe=["aria-selected","onClick"],qe={class:"pill-emoji"},Be=["src","alt"],Pe={key:1},Te={class:"pill-label"},Ee={class:"filters-row"},Le={key:0,class:"filter-badge"},Ue={class:"list"},Re={key:0,class:"empty-state"},Qe={__name:"Menu",setup(u){const y=B(),v=J(),m=g(!1),d=[{id:"p1",label:"$0 â€“ $10"},{id:"p2",label:"$10 â€“ $20"},{id:"p3",label:"$20 â€“ $30"},{id:"p4",label:"$30 â€“ $40"},{id:"p5",label:"$40 â€“ $60"},{id:"p6",label:"$60+"}],k=g([{id:"all",name:"All",emoji:"ðŸ²"}]),c=g("all"),b=async()=>{try{const a=await v.fetchPackages();if(a.success&&a.data&&a.data.length>0){const t=a.data.map(n=>({id:n.packageID.toString(),name:n.packageName,image:n.photo80?`https://menu.deegaan.so/assets/images/meals/packages/small80/${n.photo80}`:"/images/dishes/default.jpg"}));k.value=[{id:"all",name:"All",emoji:"ðŸ²",image:null},...t]}}catch(a){console.error("Error fetching categories:",a)}},h=g([]),C=g([]),p=g(null),l=g([]),s=g(""),i=()=>{const a=v.getCachedPackages;if(a&&a.length>0){const n=a.map(x=>({id:x.packageID.toString(),name:x.packageName,image:x.photo80?`https://menu.deegaan.so/assets/images/meals/packages/small80/${x.photo80}`:"/images/dishes/default.jpg"}));k.value=[{id:"all",name:"All",emoji:"ðŸ²",image:null},...n]}const t=v.getCachedItems;t&&t.length>0&&(C.value=t.map(n=>({id:n.itemID.toString(),name:n.itemName,price:parseFloat(n.costPrice),desc:n.description||"",cat:n.packageID.toString(),image:n.photo320?`https://menu.deegaan.so/assets/images/meals/items/middle320/${n.photo320}`:"/images/dishes/default.jpg",badge:n.isVegetarian?"Vegetarian":n.isSpicy?"Spicy":"",sizes:n.active_sizes||[],addons:n.active_addons||[],notes:n.notes||[]})))},w=async()=>{try{const a=await v.fetchItems();a.success&&a.data&&(C.value=a.data.map(t=>({id:t.itemID.toString(),name:t.itemName,price:parseFloat(t.costPrice),desc:t.description||"",cat:t.packageID.toString(),image:t.photo320?`https://menu.deegaan.so/assets/images/meals/items/middle320/${t.photo320}`:"/images/dishes/default.jpg",badge:t.isVegetarian?"Vegetarian":t.isSpicy?"Spicy":"",sizes:t.active_sizes||[],addons:t.active_addons||[],notes:t.notes||[]})))}catch(a){console.error("Error fetching menu items:",a)}};K(async()=>{v.hasOfflineData?i():(await b(),await w()),S()});const T=a=>{c.value=a,l.value=[],S()},S=()=>{let a=[...C.value];if(c.value!=="all"&&l.value.length===0&&(a=a.filter(t=>t.cat===c.value)),l.value.length>0&&(a=a.filter(t=>l.value.includes(t.cat))),p.value!==null&&(a=a.filter(t=>t.price<=p.value)),s.value){const t=s.value.toLowerCase();a=a.filter(n=>n.name.toLowerCase().includes(t)||n.desc.toLowerCase().includes(t))}h.value=a},V=_(()=>h.value),M=_(()=>l.value.length>0||s.value!==""||p.value!==null&&p.value!==20),E=_(()=>{let a=0;return l.value.length>0&&(a+=l.value.length),s.value!==""&&(a+=1),p.value!==null&&p.value!==20&&(a+=1),a}),L=_(()=>k.value.filter(a=>a.id!=="all").map(a=>({id:a.id,label:a.name}))),U=a=>{p.value=a.price||null,s.value=a.search||"",a.categories&&a.categories.length>0?(l.value=a.categories.map(t=>t.id),c.value="all"):(l.value=[],c.value="all"),S(),m.value=!1},R=()=>{l.value=[],p.value=null,s.value="",c.value="all",S()};function Q(a){}return(a,t)=>(o(),r(I,null,[e("div",De,[e("header",Ve,[e("button",{class:"iconbtn",onClick:t[0]||(t[0]=n=>a.$router.back()),"aria-label":"Back"},[...t[4]||(t[4]=[e("svg",{viewBox:"0 0 24 24",width:"24",height:"24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),t[6]||(t[6]=e("h1",{class:"title"},"MENU",-1)),e("button",{class:"iconbtn cartbtn","aria-label":"Cart",onClick:t[1]||(t[1]=n=>a.$router.push({name:"checkout"}))},[t[5]||(t[5]=e("svg",{viewBox:"0 0 24 24",width:"24",height:"24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"9",cy:"20",r:"1"}),e("circle",{cx:"17",cy:"20",r:"1"}),e("path",{d:"M3 3h2l2.2 11.4a2 2 0 0 0 2 1.6h7.5a2 2 0 0 0 2-1.6L21 7H6","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),q(y).count?(o(),r("span",je,f(q(y).count),1)):$("",!0)])]),e("nav",ze,[(o(!0),r(I,null,F(k.value,n=>(o(),r("button",{key:n.id,class:A(["pill",{active:n.id===c.value}]),role:"tab","aria-selected":n.id===c.value,onClick:x=>T(n.id)},[e("span",qe,[n.image?(o(),r("img",{key:0,src:n.image,alt:n.name,class:"pill-image"},null,8,Be)):(o(),r("span",Pe,f(n.emoji),1))]),e("span",Te,f(n.name),1)],10,Oe))),128))]),e("div",Ee,[e("button",{class:A(["filterbtn",{"has-filters":M.value}]),onClick:t[2]||(t[2]=n=>m.value=!0)},[t[7]||(t[7]=e("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M4 6h16M7 12h10M10 18h4","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),t[8]||(t[8]=e("span",null,"Filters",-1)),M.value?(o(),r("span",Le,f(E.value),1)):$("",!0)],2)]),e("main",Ue,[(o(!0),r(I,null,F(V.value,n=>(o(),W($e,{key:n.id,item:n,onAdd:Q},null,8,["item"]))),128)),V.value.length===0?(o(),r("div",Re,[t[9]||(t[9]=e("div",{class:"empty-icon"},"ðŸ”",-1)),t[10]||(t[10]=e("h3",{class:"empty-title"},"No items found",-1)),t[11]||(t[11]=e("p",{class:"empty-text"},"Try adjusting your filters or search terms",-1)),M.value?(o(),r("button",{key:0,class:"reset-btn",onClick:R}," Clear All Filters ")):$("",!0)])):$("",!0)])]),P(Ae,{open:m.value,categories:L.value,prices:d,onClose:t[3]||(t[3]=n=>m.value=!1),onApplyFilters:U},null,8,["open","categories"])],64))}},Ge=D(Qe,[["__scopeId","data-v-6a524019"]]);export{Ge as default};
